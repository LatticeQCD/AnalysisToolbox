<!doctype html>
<html class="no-js" lang="en" data-content_root="./">
  <head><meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="genindex.html"><link rel="search" title="Search" href="search.html"><link rel="next" title="Contributions" href="contributions/contributions.html"><link rel="prev" title="AnalysisToolbox" href="index.html">

    <!-- Generated with Sphinx 9.1.0 and Furo 2025.12.19 -->
        <title>Tutorial - AnalysisToolbox</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=d111a655" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo.css?v=7bdb33bb" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=9c3e77be" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo-extensions.css?v=8dab3a3b" />
    <link rel="stylesheet" type="text/css" href="_static/custom.css" />
    
    


<style>
  body {
    --color-code-background: #f2f2f2;
  --color-code-foreground: #1e1e1e;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle site navigation sidebar">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc" aria-label="Toggle table of contents sidebar">
<label class="overlay sidebar-overlay" for="__navigation"></label>
<label class="overlay toc-overlay" for="__toc"></label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <span class="icon"><svg><use href="#svg-menu"></use></svg></span>
      </label>
    </div>
    <div class="header-center">
      <a href="index.html"><div class="brand">AnalysisToolbox</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle" aria-label="Toggle Light / Dark / Auto color theme">
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <span class="icon"><svg><use href="#svg-toc"></use></svg></span>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="index.html">
  
  <span class="sidebar-brand-text">AnalysisToolbox</span>
  
</a><form class="sidebar-search-container" method="get" action="search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul class="current">
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">Tutorial</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="contributions/contributions.html">Contributions</a><input aria-label="Toggle navigation of Contributions" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l2"><a class="reference internal" href="contributions/testing.html">Writing Tests</a></li>
<li class="toctree-l2"><a class="reference internal" href="contributions/git.html">How to do pull requests</a></li>
<li class="toctree-l2"><a class="reference internal" href="contributions/documentation.html">Documenting your code</a></li>
<li class="toctree-l2"><a class="reference internal" href="contributions/logging.html">Logging</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="base/base.html">Basic Modules</a><input aria-label="Toggle navigation of Basic Modules" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l2"><a class="reference internal" href="base/utilities.html">Utilities</a></li>
<li class="toctree-l2"><a class="reference internal" href="base/cleanData.html">Cleaning, splicing, and organizing arrays</a></li>
<li class="toctree-l2"><a class="reference internal" href="base/speedify.html">Speedify</a></li>
<li class="toctree-l2"><a class="reference internal" href="base/plotting.html">Plotting</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="math/math.html">Math</a><input aria-label="Toggle navigation of Math" class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l2"><a class="reference internal" href="math/calculus.html">Numerical calculus</a></li>
<li class="toctree-l2"><a class="reference internal" href="math/SU3.html">SU(N) matrices</a></li>
<li class="toctree-l2"><a class="reference internal" href="math/otherMath.html">Other mathematics</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="dataAnalysis/dataAnalysis.html">Data Analysis Modules</a><input aria-label="Toggle navigation of Data Analysis Modules" class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l2"><a class="reference internal" href="dataAnalysis/curveFitting.html">Curve fitting and splines</a></li>
<li class="toctree-l2"><a class="reference internal" href="dataAnalysis/statistics.html">Statistics</a></li>
<li class="toctree-l2"><a class="reference internal" href="dataAnalysis/jackknife.html">Jackknife</a></li>
<li class="toctree-l2"><a class="reference internal" href="dataAnalysis/bootstrap.html">Bootstrapping routines</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="physicsAnalysis/physicsAnalysis.html">Physics Modules</a><input aria-label="Toggle navigation of Physics Modules" class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l2"><a class="reference internal" href="physicsAnalysis/gauge.html">Gaugefields</a></li>
<li class="toctree-l2"><a class="reference internal" href="physicsAnalysis/continuumExtrap.html">Continuum-limit extrapolation</a></li>
<li class="toctree-l2"><a class="reference internal" href="physicsAnalysis/statisticalPhysics.html">Statistical Physics</a></li>
<li class="toctree-l2"><a class="reference internal" href="physicsAnalysis/HRG.html">Hadron resonance gas</a></li>
<li class="toctree-l2"><a class="reference internal" href="physicsAnalysis/latticeParameters.html">Handling Lattice Parameters</a></li>
<li class="toctree-l2"><a class="reference internal" href="physicsAnalysis/referenceScales.html">Reference scales and physical constants</a></li>
<li class="toctree-l2"><a class="reference internal" href="physicsAnalysis/staticPotential.html">The zero-temperature static potential</a></li>
<li class="toctree-l2"><a class="reference internal" href="physicsAnalysis/freeDiracSpectra.html">Spectrum of the Dirac operator</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="interfacing/interfacing.html">Interfacing</a><input aria-label="Toggle navigation of Interfacing" class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" role="switch" type="checkbox"/><label for="toctree-checkbox-6"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l2"><a class="reference internal" href="interfacing/fileNamingConventions.html">Ensemble names and file formats</a></li>
<li class="toctree-l2"><a class="reference internal" href="interfacing/confLoader.html">Loading configurations</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="applications/applications.html">Applications</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="glossary/glossary.html">Glossary</a><input aria-label="Toggle navigation of Glossary" class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" role="switch" type="checkbox"/><label for="toctree-checkbox-7"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l2"><a class="reference internal" href="glossary/latqcdtools.base.check.html">latqcdtools.base.check</a></li>
<li class="toctree-l2"><a class="reference internal" href="glossary/latqcdtools.base.cleanData.html">latqcdtools.base.cleanData</a></li>
<li class="toctree-l2"><a class="reference internal" href="glossary/latqcdtools.base.fileSystem.html">latqcdtools.base.fileSystem</a></li>
<li class="toctree-l2"><a class="reference internal" href="glossary/latqcdtools.base.initialize.html">latqcdtools.base.initialize</a></li>
<li class="toctree-l2"><a class="reference internal" href="glossary/latqcdtools.base.logger.html">latqcdtools.base.logger</a></li>
<li class="toctree-l2"><a class="reference internal" href="glossary/latqcdtools.base.plotting.html">latqcdtools.base.plotting</a></li>
<li class="toctree-l2"><a class="reference internal" href="glossary/latqcdtools.base.printErrorBars.html">latqcdtools.base.printErrorBars</a></li>
<li class="toctree-l2"><a class="reference internal" href="glossary/latqcdtools.base.readWrite.html">latqcdtools.base.readWrite</a></li>
<li class="toctree-l2"><a class="reference internal" href="glossary/latqcdtools.base.speedify.html">latqcdtools.base.speedify</a></li>
<li class="toctree-l2"><a class="reference internal" href="glossary/latqcdtools.base.utilities.html">latqcdtools.base.utilities</a></li>
<li class="toctree-l2"><a class="reference internal" href="glossary/latqcdtools.interfaces.collaborations.html">latqcdtools.interfaces.collaborations</a></li>
<li class="toctree-l2"><a class="reference internal" href="glossary/latqcdtools.interfaces.confReader.html">latqcdtools.interfaces.confReader</a></li>
<li class="toctree-l2"><a class="reference internal" href="glossary/latqcdtools.interfaces.interfaces.html">latqcdtools.interfaces.interfaces</a></li>
<li class="toctree-l2"><a class="reference internal" href="glossary/latqcdtools.interfaces.lime.html">latqcdtools.interfaces.lime</a></li>
<li class="toctree-l2"><a class="reference internal" href="glossary/latqcdtools.interfaces.simulationManagement.html">latqcdtools.interfaces.simulationManagement</a></li>
<li class="toctree-l2"><a class="reference internal" href="glossary/latqcdtools.legacy.html">latqcdtools.legacy</a></li>
<li class="toctree-l2"><a class="reference internal" href="glossary/latqcdtools.math.SU2.html">latqcdtools.math.SU2</a></li>
<li class="toctree-l2"><a class="reference internal" href="glossary/latqcdtools.math.SU3.html">latqcdtools.math.SU3</a></li>
<li class="toctree-l2"><a class="reference internal" href="glossary/latqcdtools.math.math.html">latqcdtools.math.math</a></li>
<li class="toctree-l2"><a class="reference internal" href="glossary/latqcdtools.math.num_deriv.html">latqcdtools.math.num_deriv</a></li>
<li class="toctree-l2"><a class="reference internal" href="glossary/latqcdtools.math.num_int.html">latqcdtools.math.num_int</a></li>
<li class="toctree-l2"><a class="reference internal" href="glossary/latqcdtools.math.optimize.html">latqcdtools.math.optimize</a></li>
<li class="toctree-l2"><a class="reference internal" href="glossary/latqcdtools.math.polynomials.html">latqcdtools.math.polynomials</a></li>
<li class="toctree-l2"><a class="reference internal" href="glossary/latqcdtools.math.spline.html">latqcdtools.math.spline</a></li>
<li class="toctree-l2"><a class="reference internal" href="glossary/latqcdtools.physics.HRG.html">latqcdtools.physics.HRG</a></li>
<li class="toctree-l2"><a class="reference internal" href="glossary/latqcdtools.physics.HotQCDEOS.html">latqcdtools.physics.HotQCDEOS</a></li>
<li class="toctree-l2"><a class="reference internal" href="glossary/latqcdtools.physics.constants.html">latqcdtools.physics.constants</a></li>
<li class="toctree-l2"><a class="reference internal" href="glossary/latqcdtools.physics.continuumExtrap.html">latqcdtools.physics.continuumExtrap</a></li>
<li class="toctree-l2"><a class="reference internal" href="glossary/latqcdtools.physics.correlators.html">latqcdtools.physics.correlators</a></li>
<li class="toctree-l2"><a class="reference internal" href="glossary/latqcdtools.physics.diracFreespectra.html">latqcdtools.physics.diracFreespectra</a></li>
<li class="toctree-l2"><a class="reference internal" href="glossary/latqcdtools.physics.gauge.html">latqcdtools.physics.gauge</a></li>
<li class="toctree-l2"><a class="reference internal" href="glossary/latqcdtools.physics.ideal.html">latqcdtools.physics.ideal</a></li>
<li class="toctree-l2"><a class="reference internal" href="glossary/latqcdtools.physics.lattice.html">latqcdtools.physics.lattice</a></li>
<li class="toctree-l2"><a class="reference internal" href="glossary/latqcdtools.physics.lattice_params.html">latqcdtools.physics.lattice_params</a></li>
<li class="toctree-l2"><a class="reference internal" href="glossary/latqcdtools.physics.referenceScales.html">latqcdtools.physics.referenceScales</a></li>
<li class="toctree-l2"><a class="reference internal" href="glossary/latqcdtools.physics.runningCoupling.html">latqcdtools.physics.runningCoupling</a></li>
<li class="toctree-l2"><a class="reference internal" href="glossary/latqcdtools.physics.staticPotential.html">latqcdtools.physics.staticPotential</a></li>
<li class="toctree-l2"><a class="reference internal" href="glossary/latqcdtools.physics.statisticalPhysics.html">latqcdtools.physics.statisticalPhysics</a></li>
<li class="toctree-l2"><a class="reference internal" href="glossary/latqcdtools.statistics.autocorrelation.html">latqcdtools.statistics.autocorrelation</a></li>
<li class="toctree-l2"><a class="reference internal" href="glossary/latqcdtools.statistics.bootstr.html">latqcdtools.statistics.bootstr</a></li>
<li class="toctree-l2"><a class="reference internal" href="glossary/latqcdtools.statistics.fitting.html">latqcdtools.statistics.fitting</a></li>
<li class="toctree-l2"><a class="reference internal" href="glossary/latqcdtools.statistics.jackknife.html">latqcdtools.statistics.jackknife</a></li>
<li class="toctree-l2"><a class="reference internal" href="glossary/latqcdtools.statistics.statistics.html">latqcdtools.statistics.statistics</a></li>
<li class="toctree-l2"><a class="reference internal" href="glossary/latqcdtools.testing.html">latqcdtools.testing</a></li>
</ul>
</li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="_sources/tutorial.md.txt" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div>
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle" aria-label="Toggle Light / Dark / Auto color theme">
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <span class="icon"><svg><use href="#svg-toc"></use></svg></span>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="tutorial">
<h1>Tutorial<a class="headerlink" href="#tutorial" title="Link to this heading">¶</a></h1>
<p>Here we walk through some examples found in the <code class="docutils literal notranslate"><span class="pre">latqcdtools/examples</span></code>
directory. We try to showcase the flexibility of things like the
<a class="reference internal" href="dataAnalysis/bootstrap.html"><span class="std std-doc">bootstrap</span></a> routine, some convenience wrappers
for plotting, and some pre-packaged physics analysis code.</p>
<section id="hadron-resonance-gas-calculation">
<h2>Hadron resonance gas calculation<a class="headerlink" href="#hadron-resonance-gas-calculation" title="Link to this heading">¶</a></h2>
<p>The hadron resonance gas (HRG) model, and its implementation in the AnalysisToolbox,
is described in some detail <a class="reference internal" href="physicsAnalysis/HRG.html"><span class="std std-doc">here</span></a>. Below is a small code
that highlights some of the features of the AnalysisToolbox. For example
<code class="docutils literal notranslate"><span class="pre">initialize</span></code> simulataneously saves all screen output to the log file <code class="docutils literal notranslate"><span class="pre">HRG.log</span></code>
along with the git commit hash, so you can track down which version of the
AnalysisToolbox you used.</p>
<p>Here is <code class="docutils literal notranslate"><span class="pre">latqcdtools/examples/main_HRG_simple.py</span></code></p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">latqcdtools.base.logger</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">logger</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">latqcdtools.physics.HRG</span><span class="w"> </span><span class="kn">import</span> <span class="n">HRG</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">latqcdtools.base.readWrite</span><span class="w"> </span><span class="kn">import</span> <span class="n">readTable</span><span class="p">,</span> <span class="n">writeTable</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">latqcdtools.base.initialize</span><span class="w"> </span><span class="kn">import</span> <span class="n">initialize</span><span class="p">,</span> <span class="n">finalize</span>

<span class="c1"># Write terminal output to log file. Includes git commit hash.</span>
<span class="n">initialize</span><span class="p">(</span><span class="s1">&#39;HRG.log&#39;</span><span class="p">)</span>

<span class="c1"># Pick a temperature range in MeV</span>
<span class="n">T</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">166</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="c1"># Read in hadron names, masses, charges, baryon number, strangeness,</span>
<span class="c1"># charm, and degeneracy factor. This table is provided with AnalysisToolbox.</span>
<span class="n">QMHRG_table</span> <span class="o">=</span> <span class="s1">&#39;../latqcdtools/physics/HRGtables/QM_hadron_list_ext_strange_2020.txt&#39;</span>
<span class="n">hadrons</span><span class="p">,</span> <span class="n">M</span><span class="p">,</span> <span class="n">Q</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">g</span> <span class="o">=</span> <span class="n">readTable</span><span class="p">(</span><span class="n">QMHRG_table</span><span class="p">,</span> <span class="n">usecols</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">),</span>
                                      <span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;U11,f8,i8,i8,i8,i8,i8&quot;</span><span class="p">)</span>
<span class="n">w</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span> <span class="k">if</span> <span class="n">ba</span><span class="o">==</span><span class="mi">0</span> <span class="k">else</span> <span class="o">-</span><span class="mi">1</span> <span class="k">for</span> <span class="n">ba</span> <span class="ow">in</span> <span class="n">B</span><span class="p">])</span>

<span class="c1"># Instantiate HRG object.</span>
<span class="n">QMhrg</span> <span class="o">=</span> <span class="n">HRG</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="n">g</span><span class="p">,</span><span class="n">w</span><span class="p">,</span><span class="n">B</span><span class="p">,</span><span class="n">S</span><span class="p">,</span><span class="n">Q</span><span class="p">,</span><span class="n">C</span><span class="p">)</span>

<span class="c1"># This computation is vectorized since T is a numpy array.</span>
<span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;Computing chi2B.&#39;</span><span class="p">)</span>
<span class="n">chi</span> <span class="o">=</span> <span class="n">QMhrg</span><span class="o">.</span><span class="n">gen_chi</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">B_order</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">Q_order</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">S_order</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">C_order</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                    <span class="n">muB_div_T</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">muQ_div_T</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">muS_div_T</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">muC_div_T</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="c1"># Output T and chi2B as columns in this table.</span>
<span class="n">writeTable</span><span class="p">(</span><span class="s2">&quot;chi2B.txt&quot;</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">chi</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;T [MeV]&#39;</span><span class="p">,</span><span class="s1">&#39;chi2B (QMHRG)&#39;</span><span class="p">])</span>

<span class="n">finalize</span><span class="p">()</span>
</pre></div>
</div>
<p>In this case we work at fixed $\mu_B/T=0.3$
and compute $\chi_2^B$ as function of temperature. What is needed is as much
relevant input knowledge about hadron bound states as is known; this is
collected by <code class="docutils literal notranslate"><span class="pre">readTable</span></code>. This is a wrapper for <code class="docutils literal notranslate"><span class="pre">numpy.loadtxt()</span></code>, hence you
see you can pass it many of the same keyword arguments. The next line
for each species whether the gas is bosonic or fermionic.</p>
<p>Finally the <code class="docutils literal notranslate"><span class="pre">HRG</span></code> class is instantiated as <code class="docutils literal notranslate"><span class="pre">QMhrg</span></code>, which besides
generic conserved charge cumlants like the one computed with <code class="docutils literal notranslate"><span class="pre">gen_chi</span></code>,
contains many methods for various thermodynamic observables such as the
pressure and entropy.
The results are saved in a table <code class="docutils literal notranslate"><span class="pre">chi2B.txt</span></code>.</p>
</section>
<section id="ising-model">
<h2>Ising model<a class="headerlink" href="#ising-model" title="Link to this heading">¶</a></h2>
<p>The AnalysisToolbox is equipped with a <code class="docutils literal notranslate"><span class="pre">Lattice</span></code> class. This class takes care of
indexing, assumes you have periodic boundary conditions, and has iterators, i.e.
functions that perform some operation on every site of a subset of the lattice.
This allows you to write your own statistical mechanical simulations.</p>
<p>Here is <code class="docutils literal notranslate"><span class="pre">latqcdtools/examples/main_isingModel.py</span></code></p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">latqcdtools.physics.lattice</span><span class="w"> </span><span class="kn">import</span> <span class="n">Lattice</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">latqcdtools.base.initialize</span><span class="w"> </span><span class="kn">import</span> <span class="n">initialize</span><span class="p">,</span> <span class="n">finalize</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">latqcdtools.base.plotting</span><span class="w"> </span><span class="kn">import</span> <span class="n">latexify</span><span class="p">,</span> <span class="n">plt</span><span class="p">,</span> <span class="n">plot_dots</span><span class="p">,</span> <span class="n">set_params</span><span class="p">,</span> <span class="n">clearPlot</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">latqcdtools.base.printErrorBars</span><span class="w"> </span><span class="kn">import</span> <span class="n">get_err_str</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">latqcdtools.statistics.statistics</span><span class="w"> </span><span class="kn">import</span> <span class="n">std_mean</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">latqcdtools.base.speedify</span><span class="w"> </span><span class="kn">import</span> <span class="n">parallel_function_eval</span><span class="p">,</span> <span class="n">DEFAULTTHREADS</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">latqcdtools.base.readWrite</span><span class="w"> </span><span class="kn">import</span> <span class="n">writeTable</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">latqcdtools.statistics.jackknife</span><span class="w"> </span><span class="kn">import</span> <span class="n">jackknife</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">latqcdtools.base.logger</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">logger</span>


<span class="n">initialize</span><span class="p">(</span><span class="s1">&#39;example_ising.log&#39;</span><span class="p">)</span>
<span class="n">latexify</span><span class="p">()</span>


<span class="c1">#</span>
<span class="c1"># Simulation parameters. </span>
<span class="c1">#</span>
<span class="n">Nd</span>    <span class="o">=</span> <span class="mi">2</span>        <span class="c1"># number of dimensions</span>
<span class="n">Tlow</span>  <span class="o">=</span> <span class="mf">1.0</span>      <span class="c1"># lowest temperature to sample (kB=1)</span>
<span class="n">Thi</span>   <span class="o">=</span> <span class="mf">3.0</span>      <span class="c1"># highest temperature to sample</span>
<span class="n">h</span>     <span class="o">=</span> <span class="mf">0.</span>       <span class="c1"># external magnetic field</span>
<span class="n">L</span>     <span class="o">=</span> <span class="mi">8</span>        <span class="c1"># spatial extension</span>
<span class="n">Nequi</span> <span class="o">=</span> <span class="mi">300</span>      <span class="c1"># equilibrate with this many MCMC sweeps</span>
<span class="n">Nmeas</span> <span class="o">=</span> <span class="mi">100</span>      <span class="c1"># measure this many MCMC sweeps</span>
<span class="n">Nskip</span> <span class="o">=</span> <span class="mi">5</span>        <span class="c1"># separate measurements by this many MCMC sweeps</span>
<span class="n">start</span> <span class="o">=</span> <span class="s1">&#39;hot&#39;</span>    <span class="c1"># start with all spins up (up), down (down), or random (hot)</span>


<span class="n">Tlist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">Tlow</span><span class="p">,</span><span class="n">Thi</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">DEFAULTTHREADS</span><span class="p">)</span>
<span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
<span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;Starting parameters:&#39;</span><span class="p">)</span>
<span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;  Nequi =&#39;</span><span class="p">,</span><span class="n">Nequi</span><span class="p">)</span>
<span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;  Nmeas =&#39;</span><span class="p">,</span><span class="n">Nmeas</span><span class="p">)</span>
<span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;  Nskip =&#39;</span><span class="p">,</span><span class="n">Nskip</span><span class="p">)</span>
<span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;   Latt =&#39;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">L</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;^&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">Nd</span><span class="p">))</span>
<span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;      h =&#39;</span><span class="p">,</span><span class="n">h</span><span class="p">)</span>
<span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>


<span class="c1">#</span>
<span class="c1"># We wrap our simulation inside a function. This allows us to trivially parallelize our run</span>
<span class="c1"># over the temperatures using parallel_function_eval.</span>
<span class="c1">#</span>
<span class="k">def</span><span class="w"> </span><span class="nf">runIsingModel</span><span class="p">(</span><span class="n">T</span><span class="p">):</span>

    <span class="n">beta</span>  <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">T</span>
 
    <span class="c1"># Initialize the random number generator. When carrying out a statistical physic MCMC, it&#39;s</span>
    <span class="c1"># crucially important that you pick a good one. The default_rng() constructor is what</span>
    <span class="c1"># numpy recommends, which at the time of writing utilizes O&#39;Neill&#39;s PCG algorithm. </span>
    <span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">()</span>

    <span class="c1"># Initialize the lattice object. The first argument says the lattice geometry will be L**Nd,</span>
    <span class="c1"># while the second argument is an example of the kind of object that will be on each site.</span>
    <span class="c1"># Here each site has a scalar, so I just put in the number 1.</span>
    <span class="n">lat</span> <span class="o">=</span> <span class="n">Lattice</span><span class="p">(</span> <span class="p">(</span><span class="n">L</span><span class="p">,)</span><span class="o">*</span><span class="n">Nd</span><span class="p">,</span> <span class="mi">1</span> <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">initialize_site</span><span class="p">(</span><span class="n">coord</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">start</span> <span class="o">==</span> <span class="s1">&#39;up&#39;</span><span class="p">:</span>
            <span class="n">lat</span><span class="o">.</span><span class="n">setElement</span><span class="p">(</span><span class="n">coord</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">start</span> <span class="o">==</span> <span class="s1">&#39;down&#39;</span><span class="p">:</span>
            <span class="n">lat</span><span class="o">.</span><span class="n">setElement</span><span class="p">(</span><span class="n">coord</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">start</span> <span class="o">==</span> <span class="s1">&#39;hot&#39;</span><span class="p">:</span>
            <span class="n">lat</span><span class="o">.</span><span class="n">setElement</span><span class="p">(</span><span class="n">coord</span><span class="p">,</span><span class="n">rng</span><span class="o">.</span><span class="n">choice</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">TBError</span><span class="p">(</span><span class="s1">&#39;Unknown start option&#39;</span><span class="p">,</span><span class="n">start</span><span class="p">)</span>

    <span class="c1"># We then initialize all sites. Here interateOverRandom, whose naming convention follows that</span>
    <span class="c1"># of SIMULATeQCD, is an iterator that applies the function initialize_site to each site.</span>
    <span class="c1"># The function should take an array-like coord as argument. Look into the Lattice class to</span>
    <span class="c1"># see what other iterators are possible. </span>
    <span class="n">lat</span><span class="o">.</span><span class="n">iterateOverRandom</span><span class="p">(</span><span class="n">initialize_site</span><span class="p">)</span>
    

    <span class="k">def</span><span class="w"> </span><span class="nf">getMagnetization</span><span class="p">():</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Order parameter is |M|. &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">lat</span><span class="o">.</span><span class="n">grid</span><span class="p">)</span><span class="o">/</span><span class="n">lat</span><span class="o">.</span><span class="n">vol</span><span class="p">)</span>
    
    
    <span class="k">def</span><span class="w"> </span><span class="nf">mcLocal</span><span class="p">(</span><span class="n">coord</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; The Markov step. </span>

<span class="sd">        Args:</span>
<span class="sd">            coord (array-like): local coordinate </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">s0</span> <span class="o">=</span> <span class="n">lat</span><span class="o">.</span><span class="n">getElement</span><span class="p">(</span><span class="n">coord</span><span class="p">)</span>
        <span class="n">NNsum</span> <span class="o">=</span> <span class="mf">0.</span>
        <span class="k">for</span> <span class="n">mu</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">Nd</span><span class="p">):</span>
            <span class="n">NNsum</span> <span class="o">+=</span> <span class="n">lat</span><span class="o">.</span><span class="n">getElement</span><span class="p">(</span><span class="n">lat</span><span class="o">.</span><span class="n">march</span><span class="p">(</span><span class="n">coord</span><span class="p">,</span><span class="n">mu</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span> <span class="o">+</span> <span class="n">lat</span><span class="o">.</span><span class="n">getElement</span><span class="p">(</span><span class="n">lat</span><span class="o">.</span><span class="n">march</span><span class="p">(</span><span class="n">coord</span><span class="p">,</span><span class="n">mu</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
        <span class="n">dH</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">beta</span><span class="o">*</span><span class="n">s0</span><span class="o">*</span><span class="n">NNsum</span>
        <span class="k">if</span> <span class="n">dH</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">lat</span><span class="o">.</span><span class="n">setElement</span><span class="p">(</span><span class="n">coord</span><span class="p">,</span><span class="o">-</span><span class="n">s0</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">rng</span><span class="o">.</span><span class="n">random</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dH</span><span class="p">):</span>
            <span class="n">lat</span><span class="o">.</span><span class="n">setElement</span><span class="p">(</span><span class="n">coord</span><span class="p">,</span><span class="o">-</span><span class="n">s0</span><span class="p">)</span>
    

    <span class="c1"># Equilibrate the lattice by carrying out Nequi equilibration steps.   </span>
    <span class="k">for</span> <span class="n">iequi</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">Nequi</span><span class="p">):</span>
        <span class="n">lat</span><span class="o">.</span><span class="n">iterateOverRandom</span><span class="p">(</span><span class="n">mcLocal</span><span class="p">)</span>
    

    <span class="c1"># With the remaining MCMC steps, we measure the magnetization. We skip every Nskip MCMC </span>
    <span class="c1"># steps to reduce autocorrelation.    </span>
    <span class="n">magnetizations</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">imeas</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">Nmeas</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">iskip</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">Nskip</span><span class="p">):</span>
            <span class="n">lat</span><span class="o">.</span><span class="n">iterateOverRandom</span><span class="p">(</span><span class="n">mcLocal</span><span class="p">)</span>
        <span class="n">magnetizations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">getMagnetization</span><span class="p">())</span>
    <span class="n">magnetizations</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">magnetizations</span><span class="p">)</span> 


    <span class="k">def</span><span class="w"> </span><span class="nf">chi_M</span><span class="p">(</span><span class="n">M</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Magnetic susceptibility. &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">lat</span><span class="o">.</span><span class="n">vol</span><span class="o">*</span><span class="p">(</span> <span class="n">std_mean</span><span class="p">(</span><span class="n">M</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">-</span><span class="n">std_mean</span><span class="p">(</span><span class="n">M</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="p">)</span>


    <span class="k">def</span><span class="w"> </span><span class="nf">binder</span><span class="p">(</span><span class="n">M</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Binder cumulant. For the ising model in 2d, this should tend to 2/3 below</span>
<span class="sd">        Tc, while it should tend to 0 above Tc, in the thermodynamic limit. &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="mi">1</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">M</span><span class="o">**</span><span class="mi">4</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">M</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>


    <span class="c1"># We have parallelized over the temperatures, so we&#39;re not allowed to parallelize over the jackknife:</span>
    <span class="c1"># that would be nested parallelization!</span>
    <span class="n">Mm</span>  <span class="p">,</span> <span class="n">Me</span>   <span class="o">=</span> <span class="n">jackknife</span><span class="p">(</span> <span class="n">std_mean</span><span class="p">,</span> <span class="n">magnetizations</span><span class="p">,</span> <span class="n">nproc</span><span class="o">=</span><span class="mi">1</span> <span class="p">)</span>
    <span class="n">chim</span><span class="p">,</span> <span class="n">chie</span> <span class="o">=</span> <span class="n">jackknife</span><span class="p">(</span> <span class="n">chi_M</span>   <span class="p">,</span> <span class="n">magnetizations</span><span class="p">,</span> <span class="n">nproc</span><span class="o">=</span><span class="mi">1</span> <span class="p">)</span>
    <span class="n">Bm</span>  <span class="p">,</span> <span class="n">Be</span>   <span class="o">=</span> <span class="n">jackknife</span><span class="p">(</span> <span class="n">binder</span>  <span class="p">,</span> <span class="n">magnetizations</span><span class="p">,</span> <span class="n">nproc</span><span class="o">=</span><span class="mi">1</span> <span class="p">)</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;T, &lt;|M|&gt;, chi, B =&#39;</span><span class="p">,</span><span class="nb">round</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="n">get_err_str</span><span class="p">(</span><span class="n">Mm</span><span class="p">,</span><span class="n">Me</span><span class="p">),</span><span class="n">get_err_str</span><span class="p">(</span><span class="n">chim</span><span class="p">,</span><span class="n">chie</span><span class="p">),</span><span class="n">get_err_str</span><span class="p">(</span><span class="n">Bm</span><span class="p">,</span><span class="n">Be</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">Mm</span><span class="p">,</span> <span class="n">Me</span><span class="p">,</span> <span class="n">chim</span><span class="p">,</span> <span class="n">chie</span><span class="p">,</span> <span class="n">Bm</span><span class="p">,</span> <span class="n">Be</span>


<span class="c1"># Parallelize over the temperatures. This parallelization strategy is easiest since each temperature</span>
<span class="c1"># amounts to an independent run.</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">parallel_function_eval</span><span class="p">(</span><span class="n">runIsingModel</span><span class="p">,</span><span class="n">Tlist</span><span class="p">)</span>


<span class="n">res_M</span>    <span class="o">=</span> <span class="p">[]</span>
<span class="n">res_E</span>    <span class="o">=</span> <span class="p">[]</span>
<span class="n">res_chi</span>  <span class="o">=</span> <span class="p">[]</span>
<span class="n">res_chie</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">res_B</span>    <span class="o">=</span> <span class="p">[]</span>
<span class="n">res_Be</span>   <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">Tlist</span><span class="p">)):</span>
    <span class="n">res_M</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>   <span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">res_E</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>   <span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">res_chi</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">2</span><span class="p">])</span>
    <span class="n">res_chie</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">3</span><span class="p">])</span>
    <span class="n">res_B</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>   <span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">4</span><span class="p">])</span>
    <span class="n">res_Be</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>  <span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">5</span><span class="p">])</span>


<span class="c1"># Plot the magnetization.</span>
<span class="n">plot_dots</span><span class="p">(</span><span class="n">Tlist</span><span class="p">,</span><span class="n">res_M</span><span class="p">,</span><span class="n">res_E</span><span class="p">)</span>
<span class="n">set_params</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;$T$&#39;</span><span class="p">,</span><span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;$</span><span class="se">\\</span><span class="s1">ev{|M|}$&#39;</span><span class="p">,</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;$V=&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">L</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;^&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">Nd</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;$ Ising model&#39;</span><span class="p">,</span><span class="n">alpha_xlabel</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="n">clearPlot</span><span class="p">()</span>


<span class="c1"># Plot the magnetic susceptibility.</span>
<span class="n">plot_dots</span><span class="p">(</span><span class="n">Tlist</span><span class="p">,</span><span class="n">res_chi</span><span class="p">,</span><span class="n">res_chie</span><span class="p">)</span>
<span class="n">set_params</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;$T$&#39;</span><span class="p">,</span><span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;$</span><span class="se">\\</span><span class="s1">ev{</span><span class="se">\\</span><span class="s1">chi}$&#39;</span><span class="p">,</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;$V=&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">L</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;^&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">Nd</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;$ Ising model&#39;</span><span class="p">,</span><span class="n">alpha_xlabel</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>


<span class="c1"># Record the results in a nicely formatted table.</span>
<span class="n">writeTable</span><span class="p">(</span><span class="s1">&#39;ising_&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">L</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;_&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">Nd</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;.d&#39;</span><span class="p">,</span><span class="n">Tlist</span><span class="p">,</span><span class="n">res_M</span><span class="p">,</span><span class="n">res_E</span><span class="p">,</span><span class="n">res_chi</span><span class="p">,</span><span class="n">res_chie</span><span class="p">,</span><span class="n">res_B</span><span class="p">,</span><span class="n">res_Be</span><span class="p">,</span>
           <span class="n">header</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;T&#39;</span><span class="p">,</span><span class="s1">&#39;|M|&#39;</span><span class="p">,</span><span class="s1">&#39;|M|_err&#39;</span><span class="p">,</span><span class="s1">&#39;chi&#39;</span><span class="p">,</span><span class="s1">&#39;chi_err&#39;</span><span class="p">,</span><span class="s1">&#39;B&#39;</span><span class="p">,</span><span class="s1">&#39;Be&#39;</span><span class="p">])</span>
<span class="n">finalize</span><span class="p">()</span>
</pre></div>
</div>
<p>Again, the most useful feature of this example is the <code class="docutils literal notranslate"><span class="pre">Lattice</span></code> class. This wraps a
lattice that saves an object of arbitrary type at each site, here scalars. You can move
one site in a direction using <code class="docutils literal notranslate"><span class="pre">march</span></code>. In the Metropolis step, we feature the lattice
accessors <code class="docutils literal notranslate"><span class="pre">getElement</span></code> and <code class="docutils literal notranslate"><span class="pre">setElement</span></code>. To deal with autocorrelation and propagate
error, we use the <a class="reference internal" href="dataAnalysis/jackknife.html"><span class="std std-doc">jackknife</span></a> class.</p>
</section>
<section id="continuum-limit-extrapolation">
<h2>Continuum-limit extrapolation<a class="headerlink" href="#continuum-limit-extrapolation" title="Link to this heading">¶</a></h2>
<p>Suppose we want to perform a continuum-limit extrapolation to
determine the deconfinement transition temperature $T_d$ in pure SU(3). The order
parameter for this phase transition is given by the Polyakov loop, $P$.
The transition is first-order in the
thermodynamic limit, where $\langle |P|\rangle$ as function of temperature
would jump discontinuously at $T_d$.
At finite volume, this abrupt jump becomes smooth, and $T_d$ is estimated by the
inflection point of the curve.</p>
<p>Here is <code class="docutils literal notranslate"><span class="pre">latqcdtools/examples/main_continuumExtrapolate.py</span></code></p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">latqcdtools.base.logger</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">logger</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">latqcdtools.base.readWrite</span><span class="w"> </span><span class="kn">import</span> <span class="n">readTable</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">latqcdtools.base.printErrorBars</span><span class="w"> </span><span class="kn">import</span> <span class="n">get_err_str</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">latqcdtools.base.initialize</span><span class="w"> </span><span class="kn">import</span> <span class="n">initialize</span><span class="p">,</span> <span class="n">finalize</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">latqcdtools.math.num_deriv</span><span class="w"> </span><span class="kn">import</span> <span class="n">diff_deriv</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">latqcdtools.math.spline</span><span class="w"> </span><span class="kn">import</span> <span class="n">getSpline</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">latqcdtools.statistics.statistics</span><span class="w"> </span><span class="kn">import</span> <span class="n">gaudif</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">latqcdtools.statistics.bootstr</span><span class="w"> </span><span class="kn">import</span> <span class="n">bootstr_from_gauss</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">latqcdtools.physics.continuumExtrap</span><span class="w"> </span><span class="kn">import</span> <span class="n">continuumExtrapolate</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">latqcdtools.physics.constants</span><span class="w"> </span><span class="kn">import</span> <span class="n">r0_phys</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">latqcdtools.physics.lattice_params</span><span class="w"> </span><span class="kn">import</span> <span class="n">latticeParams</span>

<span class="n">initialize</span><span class="p">(</span><span class="s1">&#39;cont.log&#39;</span><span class="p">)</span>

<span class="n">Nts</span>         <span class="o">=</span> <span class="p">[</span><span class="mi">6</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">12</span><span class="p">,</span><span class="mi">14</span><span class="p">,</span><span class="mi">16</span><span class="p">,</span><span class="mi">18</span><span class="p">,</span><span class="mi">20</span><span class="p">]</span>
<span class="n">Tds</span><span class="p">,</span> <span class="n">Tderrs</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">Nt</span> <span class="ow">in</span> <span class="n">Nts</span><span class="p">:</span>

    <span class="n">T</span>  <span class="o">=</span> <span class="p">[]</span>
    <span class="n">Ns</span> <span class="o">=</span> <span class="n">Nt</span><span class="o">*</span><span class="mi">3</span>

    <span class="c1"># Read in Polyakov loop measurements, </span>
    <span class="n">beta</span><span class="p">,</span> <span class="n">PM</span><span class="p">,</span> <span class="n">PE</span> <span class="o">=</span> <span class="n">readTable</span><span class="p">(</span><span class="s1">&#39;ploop/Nt&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">Nt</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;.txt&#39;</span><span class="p">,</span><span class="n">usecols</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>

    <span class="c1"># Create array of temperatures in physical units</span>
    <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">beta</span><span class="p">:</span>
        <span class="n">lp</span> <span class="o">=</span> <span class="n">latticeParams</span><span class="p">(</span><span class="n">Ns</span><span class="p">,</span> <span class="n">Nt</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">scaleType</span><span class="o">=</span><span class="s1">&#39;r0&#39;</span><span class="p">)</span> 
        <span class="n">T</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">lp</span><span class="o">.</span><span class="n">getT</span><span class="p">()</span> <span class="p">)</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">T</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="mi">1001</span><span class="p">)</span>

    <span class="c1"># Extract Td from inflection point of &lt;|P|&gt; vs T using natural spline</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">getTd</span><span class="p">(</span><span class="n">pm</span><span class="p">):</span>
        <span class="n">spl</span>  <span class="o">=</span> <span class="n">getSpline</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">pm</span><span class="p">,</span> <span class="n">natural</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">dPdT</span> <span class="o">=</span> <span class="n">diff_deriv</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">spl</span><span class="p">)</span>
        <span class="n">maxIndex</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">dPdT</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">t</span><span class="p">[</span><span class="n">maxIndex</span><span class="p">]</span>

    <span class="c1"># Error in Td estimate comes from 1000 Gaussian bootstrap samples</span>
    <span class="n">Td</span><span class="p">,</span> <span class="n">Tde</span> <span class="o">=</span> <span class="n">bootstr_from_gauss</span><span class="p">(</span><span class="n">getTd</span><span class="p">,</span> <span class="n">PM</span><span class="p">,</span> <span class="n">PE</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
    <span class="n">Tds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Td</span><span class="p">)</span>
    <span class="n">Tderrs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Tde</span><span class="p">)</span>

<span class="c1"># Perform O(a^4) continuum-limit extrapolation</span>
<span class="n">result</span><span class="p">,</span> <span class="n">result_err</span><span class="p">,</span> <span class="n">chidof</span> <span class="o">=</span> <span class="n">continuumExtrapolate</span><span class="p">(</span> <span class="n">Nts</span><span class="p">,</span> <span class="n">Tds</span><span class="p">,</span> <span class="n">Tderrs</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">xtype</span><span class="o">=</span><span class="s2">&quot;Nt&quot;</span><span class="p">,</span>
                                                   <span class="n">show_results</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">plot_results</span><span class="o">=</span><span class="kc">True</span> <span class="p">)</span>

<span class="c1"># Do a Z-test against literature result,  </span>
<span class="n">r0</span> <span class="o">=</span> <span class="n">r0_phys</span><span class="p">(</span><span class="n">year</span><span class="o">=</span><span class="mi">2014</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s2">&quot;MeVinv&quot;</span><span class="p">)</span>
<span class="n">Tdr0</span><span class="p">,</span> <span class="n">Tdr0e</span> <span class="o">=</span> <span class="n">r0</span> <span class="o">*</span> <span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">r0</span> <span class="o">*</span> <span class="n">result_err</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">Tdr0_lit</span><span class="p">,</span> <span class="n">Tdr0_lite</span> <span class="o">=</span> <span class="mf">0.7457</span><span class="p">,</span> <span class="mf">0.0045</span>
<span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;q(ours vs. lit) =&#39;</span><span class="p">,</span><span class="n">gaudif</span><span class="p">(</span><span class="n">Tdr0</span><span class="p">,</span><span class="n">Tdr0e</span><span class="p">,</span><span class="n">Tdr0_lit</span><span class="p">,</span><span class="n">Tdr0_lite</span><span class="p">))</span>

<span class="n">finalize</span><span class="p">()</span>
</pre></div>
</div>
<p>Above we show how such an extrapolation is achieved with
the AnalysisToolbox, along with error estimation, plotting the results, and
carrying out a statistical comparison with the known literature value.
We assume you already have results for $\langle |P|\rangle$ at various $N_\tau$, which we
read in from tables of the form <code class="docutils literal notranslate"><span class="pre">Nt6.txt</span></code>.
For each $N_\tau$, this code estimates the inflection point of $\langle |P|\rangle$ as a function
of $T$ by taking a <a class="reference internal" href="math/calculus.html"><span class="std std-doc">derivative</span></a> using a
<a class="reference internal" href="dataAnalysis/curveFitting.html"><span class="std std-doc">spline</span></a> to get $T_d(N_\tau)$.
Temperatures are calculated in MeV with the help of our
<a class="reference internal" href="physicsAnalysis/latticeParameters.html"><span class="std std-doc">class</span></a> that collects ensemble parameters. This
procedure is wrapped in a user-defined function <code class="docutils literal notranslate"><span class="pre">getTc</span></code>,
so that errors in the $\langle |P| \rangle$ data can be
conveniently propagated into the error in $T_d(N_\tau)$
using a Gaussian <a class="reference internal" href="dataAnalysis/bootstrap.html"><span class="std std-doc">bootstrap</span></a>.</p>
<p>Having the <code class="docutils literal notranslate"><span class="pre">Nts</span></code>, <code class="docutils literal notranslate"><span class="pre">Tds</span></code>, and <code class="docutils literal notranslate"><span class="pre">Tderrs</span></code>, we are ready to perform a
continuum-limit extrapolation. This will perform an
extrapolation to second order in $a^2$, i.e. $\mathcal{O}(a^4)$, print the fit
results to screen, and create a plot of the extrapolation for you.
The arrays <code class="docutils literal notranslate"><span class="pre">result</span></code> and <code class="docutils literal notranslate"><span class="pre">result_err</span></code> contain the best fit parameters
along with their errors, with <code class="docutils literal notranslate"><span class="pre">result[0]</span></code> being the continuum value $T_d$.
In the last block we compare our result with $T_d r_0$ from the
<a class="reference external" href="https://journals.aps.org/prd/abstract/10.1103/PhysRevD.91.096002">literature</a>.
The temperatures calculated in this code implicitly had units of
MeV, hence we need $r_0$ in <a class="reference internal" href="physicsAnalysis/referenceScales.html"><span class="std std-doc">physical units</span></a>.
Finally we call <code class="docutils literal notranslate"><span class="pre">gaudif</span></code> to carry out a Gaussian difference test or
Z-test, which is implemented in our <a class="reference internal" href="dataAnalysis/statistics.html"><span class="std std-doc">statistics</span></a> module.</p>
</section>
<section id="statistical-bootstrap">
<h2>Statistical bootstrap<a class="headerlink" href="#statistical-bootstrap" title="Link to this heading">¶</a></h2>
<p>Here is <code class="docutils literal notranslate"><span class="pre">latqcdtools/examples/main_bootstrap.py</span></code></p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">latqcdtools.base.readWrite</span><span class="w"> </span><span class="kn">import</span> <span class="n">readTable</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">latqcdtools.math.spline</span><span class="w"> </span><span class="kn">import</span> <span class="n">getSpline</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">latqcdtools.base.plotting</span><span class="w"> </span><span class="kn">import</span> <span class="n">plt</span><span class="p">,</span> <span class="n">plot_dots</span><span class="p">,</span> <span class="n">plot_band</span><span class="p">,</span> <span class="n">latexify</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">latqcdtools.statistics.bootstr</span><span class="w"> </span><span class="kn">import</span> <span class="n">bootstr_from_gauss</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">latqcdtools.base.initialize</span><span class="w"> </span><span class="kn">import</span> <span class="n">initialize</span><span class="p">,</span> <span class="n">finalize</span>

<span class="n">initialize</span><span class="p">(</span><span class="s1">&#39;example_bootstrap.log&#39;</span><span class="p">)</span>

<span class="n">latexify</span><span class="p">()</span>

<span class="n">xdata</span><span class="p">,</span> <span class="n">ydata</span><span class="p">,</span> <span class="n">edata</span> <span class="o">=</span> <span class="n">readTable</span><span class="p">(</span><span class="s2">&quot;../testing/statistics/wurf.dat&quot;</span><span class="p">,</span> <span class="n">usecols</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>

<span class="n">plot_dots</span><span class="p">(</span><span class="n">xdata</span><span class="p">,</span><span class="n">ydata</span><span class="p">,</span><span class="n">edata</span><span class="p">)</span>

<span class="c1"># We will interpolate to these x-values</span>
<span class="n">xspline</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">xdata</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">xdata</span><span class="p">),</span><span class="mi">101</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">splineError</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; We assume no errors in the xdata. For the ydata, we will pass the bootstrap</span>
<span class="sd">    routine ydata along with the errors. The input to this function, data, will then</span>
<span class="sd">    be generated in each bootstrap bin by drawing normally from ydata with a spread</span>
<span class="sd">    of edata. In this example we simply get a spline, but you wrap anything you want</span>
<span class="sd">    inside your bootstrap procedure.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">ys</span> <span class="o">=</span> <span class="n">getSpline</span><span class="p">(</span><span class="n">xdata</span><span class="p">,</span><span class="n">data</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ys</span><span class="p">(</span><span class="n">xspline</span><span class="p">)</span>

<span class="n">ybs</span><span class="p">,</span> <span class="n">ybserr</span> <span class="o">=</span> <span class="n">bootstr_from_gauss</span><span class="p">(</span><span class="n">splineError</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="n">ydata</span><span class="p">,</span><span class="n">data_std_dev</span><span class="o">=</span><span class="n">edata</span><span class="p">,</span><span class="n">numb_samples</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>

<span class="n">plot_band</span><span class="p">(</span><span class="n">xspline</span><span class="p">,</span><span class="n">ybs</span><span class="o">-</span><span class="n">ybserr</span><span class="p">,</span><span class="n">ybs</span><span class="o">+</span><span class="n">ybserr</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;bootstrapped interpolation&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">finalize</span><span class="p">()</span>
</pre></div>
</div>
<p>In the above example we created an interpolated band using the data; there are 100 bootstrap
samples, where each data point is drawn from <code class="docutils literal notranslate"><span class="pre">normal(ydata,edata)</span></code>. The error is taken by
default to be the 68-percentile bounds, and the central value is given as the median. Like
the <code class="docutils literal notranslate"><span class="pre">jackknife</span></code> from the Ising model example, the bootstrap routine is parallelized by default.</p>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="contributions/contributions.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Contributions</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="index.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Home</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2026, LatticeQCD
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Tutorial</a><ul>
<li><a class="reference internal" href="#hadron-resonance-gas-calculation">Hadron resonance gas calculation</a></li>
<li><a class="reference internal" href="#ising-model">Ising model</a></li>
<li><a class="reference internal" href="#continuum-limit-extrapolation">Continuum-limit extrapolation</a></li>
<li><a class="reference internal" href="#statistical-bootstrap">Statistical bootstrap</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="_static/documentation_options.js?v=8ca9e7a0"></script>
    <script src="_static/doctools.js?v=fd6eb6e6"></script>
    <script src="_static/sphinx_highlight.js?v=6ffebe34"></script>
    <script src="_static/scripts/furo.js?v=46bd48cc"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=1ae7504c"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    </body>
</html>